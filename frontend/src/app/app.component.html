<div class="container">
  <h1 class="title">RAG DEMO APP</h1>

  <button
    class="history-search"
    nz-button
    nzType="default"
    (click)="onSearchHistory()"
  >
    Xem lịch sử tìm kiếm
  </button>

  <div class="grid">
    <div class="column">
      <div class="box">
        <h2>Upload File</h2>
        <div class="lbox">
          <input type="file" (change)="onFileSelected($event)" />
          <button class="btn" nz-button nzType="primary" (click)="upload()">
            Upload
          </button>
        </div>
        <p class="message" *ngIf="uploadMessage">{{ uploadMessage }}</p>
      </div>

      <div class="box">
        <h2>Danh sách file đã upload</h2>
        <table *ngIf="uploadedFiles.length > 0">
          <thead>
            <tr>
              <th>STT</th>
              <th>File Name</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let f of uploadedFiles; let i = index">
              <td>{{ i + 1 }}</td>
              <td>{{ f.fileName }}</td>
            </tr>
          </tbody>
        </table>
        <p *ngIf="uploadedFiles.length === 0">Chưa có file nào được upload.</p>
      </div>
    </div>

    <div class="column">
      <div class="box">
        <h2>Tìm kiếm</h2>
        <div class="form-group">
          <input [(ngModel)]="query" placeholder="Nhập nội dung" />
          <button class="btn" nz-button nzType="primary" (click)="search()">
            Search
          </button>
        </div>

        <div *ngIf="results.length > 0" class="results">
          <table>
            <thead>
              <tr>
                <th>File</th>
                <th>Độ tương đồng</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let r of results">
                <td>{{ r.tenFile }}</td>
                <td>{{ r.doTuongDong === 0 ? "" : r.doTuongDong }}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <div class="scan-interval">
    <p>Thời gian quét data: {{ scanInterval / 1000 }}s một lần.</p>
    <p class="scan-message" *ngIf="scanMessage">{{ scanMessage }}</p>
    <label>
      Đổi thời gian (giây):
      <input type="number" [(ngModel)]="scanIntervalInput" min="1" />
      <button nz-button nzType="default" (click)="updateScanInterval()">
        Cập nhật
      </button>
    </label>
  </div>
</div>
<router-outlet></router-outlet>
<router-outlet name="left"></router-outlet>
<router-outlet name="right"></router-outlet>
